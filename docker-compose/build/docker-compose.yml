version: '3.1'
services:
  jenkins:
    image: jenkins/jenkins:lts
    volumes:
      - jenkins_data:/var/jenkins_home
      - /var/run/docker.sock:/var/run/docker.sock
      - /usr/local/bin/docker:/usr/local/bin/docker
    networks: 
      - web
    labels:
        - "traefik.enable=true"
        - "traefik.http.routers.cyriltavian.rule=Host(`build.cyril-tavian.fr`)"
        - "traefik.http.routers.cyriltavian.entrypoints=websecure"
        - "traefik.http.routers.cyriltavian.tls.certresolver=letsencrypt"
    restart: always
networks:
  web: 
    external: true
volumes:
  jenkins_data: